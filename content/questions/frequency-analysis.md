---
filename: frequency-analysis.md
title: Частотный анализ изображений. Спектр и фаза. Полосно-пропускающий фильтр.
Summary: >
    Частотный анализ - метод обработки изображений, в котором картинка
    представляется в виде суммы синусов и косинусов на основе преобразования
    фурье
date: 2022-01-10T06:05:43.581Z
билеты: Билет 10
draft: false
weight: 22
author: Sergey Krukov
cover:
    image: https://habrastorage.org/r/w1560/storage3/de7/96d/70f/de796d70f6772832ece34628824f46af.png
---
## Частотный анализ изображений

### Что такое частотный анализ?

**Частотный анализ** - метод обработки изображений, в котором картинка представляется в виде суммы синусов и 
косинусов на основе преобразования фурье.

### Преобразование Фурье

Согласно теореме Фурье - любую абсолютно интегрируемую (площадь графика под ней конечна) функцию можно разложить в ряд Фурье.

Другими словами новая функция (полученный ряд фурье) описывает коэффициенты (амплитуды) при разложении исходной
функции на элементарные составляющие — гармонические колебания с разными частотами.

Преобразование Фурье функции \\( f \\) вещественной переменной является интегральным и задаётся следующей формулой:

{{< figure src="https://wikimedia.org/api/rest_v1/media/math/render/svg/d3efd1032c26b666767810351b51c58443bdb48c"
class="figure__image" >}}

> Это комплексная форма, переход от косинусов и синусов делается с помощью формулы Эйлера

### Преобразование фурье для изображений

Во-первых, изображение можно представить в виде функции двух переменных. 

Преобразование Фурье функций, заданных на пространстве \\( R^n \\), определяется формулой

{{< figure src="https://wikimedia.org/api/rest_v1/media/math/render/svg/af4add7da37265871225e4a70687dbae31239444"
class="figure__image" >}}

> В случае изображений \\( n=2 \\)

Во-вторых, изображение это дискретная функция. По этому необходимо использовать дискретную версию
преобразования Фурье.

Таким образом:

{{< figure src="/images/uploads/furie/img.png"
class="figure__image" >}}

\\( f \\) (в дискретном случае \\( I \\) ) - это изображение \\( M \\) x \\( N \\) пикселей

\\( (x, y) \\) - координаты пикселей исходного изображения

\\( (u, v) \\) - координаты в частотных координатах в **прямоугольнике частот** (размером \\( M \\) x \\( N \\)).
Эти параметры задают частоту.

\\( j \\) (обычно обозначается как \\( i \\)) - это комплексное число, равное \\( \sqrt{-1} \\)


### Амплитудный и фазовый спектры

Вообще говоря после преобразование фурье функция \\( F \\) не является существенной (то есть она может принимать комплексные 
значения).

Для анализа изображения мы можем посчитать амплитуду и посчитать фазу.

{{< figure src="/images/uploads/furie/img_1.png"
class="figure__image" >}}

> Амплитудный спектр, как правило, представляет намного больший интерес, а потому “фазовую” часть спектра 
> нередко пропускают. 
 
> Но забывать про существование пропущенной фазовой части графика не следует (так как она используется при обратном преобразовании).


### Пример спектра

{{< figure src="/images/uploads/furie/img_2.png"
class="figure__image" >}}

### Полосно-пропускающий фильтр

Полосно-пропускающий фильтр - это фильтр пропускающий частотный спектр сигнала определенной частоты 
(выше или ниже в рамках установленных границ которые называют полосой пропускания).

{{< figure src="/images/uploads/furie/img_3.png"
class="figure__image" >}}

В обработке изображений низкочастотные фильтры используются для очистки картинки от шума и создания 
спецэффектов, а также при сжатии изображений.

## Свертка с использованием преобразования Фурье

### Теорема о свертке

Преобразование Фурье над двумя свернутыми функциями пропорционально результатам преобразований Фурье
над каждой функцией в отдельности.

{{< figure src="/images/uploads/furie/img_4.png"
class="figure__image" >}}

### Алгоритм свертки

Алгоритм свертки изображения \\( f(x,y) \\)  фильтром \\( h(x,y) \\)

1. Получить преобразования Фурье \\( F(u,v) \\), \\( H(u,v) \\)
2. Поточечно перемножить \\( F(u,v) \\) и \\( H(u,v) \\) получить \\( G(u,v) \\)
3. Применить обратное преобразование Фурье к \\( G(u,v) \\) для получения результата

{{< figure src="/images/uploads/furie/img_5.png"
class="figure__image" >}}

## Применение преобразования Фурье

- Полосная фильтрация
- Определение степени размытости
- Сжатие изображения
- Описание текстуры изображения
- Быстрая фильтрация сверткой (размер фильтра > 5)
- Поиск объекта на изображении (используя теорему о свёртке)
